import { CdkStep, CdkStepper, STEPPER_GLOBAL_OPTIONS, } from '@angular/cdk/stepper';
import { ChangeDetectionStrategy, Component, ContentChild, ContentChildren, EventEmitter, forwardRef, Inject, Input, Optional, Output, QueryList, SkipSelf, ViewChildren, ViewEncapsulation, } from '@angular/core';
import { ErrorStateMatcher } from '@angular/material/core';
import { TemplatePortal } from '@angular/cdk/portal';
import { Subject, Subscription } from 'rxjs';
import { takeUntil, distinctUntilChanged, map, startWith, switchMap } from 'rxjs/operators';
import { EsnStepHeader } from './step-header';
import { EsnStepLabel } from './step-label';
import { DEFAULT_HORIZONTAL_ANIMATION_DURATION, DEFAULT_VERTICAL_ANIMATION_DURATION, esnStepperAnimations, } from './stepper-animations';
import { EsnStepperIcon } from './stepper-icon';
import { EsnStepContent } from './step-content';
import { EsnUtils } from '../../utils/public-api';
import * as i0 from "@angular/core";
import * as i1 from "@angular/material/core";
import * as i2 from "@angular/cdk/portal";
import * as i3 from "@angular/cdk/bidi";
import * as i4 from "@angular/cdk/layout";
import * as i5 from "@angular/common";
import * as i6 from "./step-header";
export class EsnStep extends CdkStep {
    constructor(stepper, _errorStateMatcher, _viewContainerRef, stepperOptions) {
        super(stepper, stepperOptions);
        this._errorStateMatcher = _errorStateMatcher;
        this._viewContainerRef = _viewContainerRef;
        this._isSelected = Subscription.EMPTY;
    }
    ngAfterContentInit() {
        this._isSelected = this._stepper.steps.changes
            .pipe(switchMap(() => {
            return this._stepper.selectionChange.pipe(map(event => event.selectedStep === this), startWith(this._stepper.selected === this));
        }))
            .subscribe(isSelected => {
            if (isSelected && this._lazyContent && !this._portal) {
                this._portal = new TemplatePortal(this._lazyContent._template, this._viewContainerRef);
            }
        });
    }
    ngOnDestroy() {
        this._isSelected.unsubscribe();
    }
    /** Custom error state matcher that additionally checks for validity of interacted form. */
    isErrorState(control, form) {
        const originalErrorState = this._errorStateMatcher.isErrorState(control, form);
        // Custom error state checks for the validity of form that is not submitted or touched
        // since user can trigger a form change by calling for another step without directly
        // interacting with the current form.
        const customErrorState = !!(control && control.invalid && this.interacted);
        return originalErrorState || customErrorState;
    }
}
EsnStep.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.10", ngImport: i0, type: EsnStep, deps: [{ token: forwardRef(() => EsnStepper) }, { token: i1.ErrorStateMatcher, skipSelf: true }, { token: i0.ViewContainerRef }, { token: STEPPER_GLOBAL_OPTIONS, optional: true }], target: i0.ɵɵFactoryTarget.Component });
EsnStep.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.10", type: EsnStep, selector: "esn-step", inputs: { esnIcon: "esnIcon" }, providers: [
        { provide: ErrorStateMatcher, useExisting: EsnStep },
        { provide: CdkStep, useExisting: EsnStep },
    ], queries: [{ propertyName: "stepLabel", first: true, predicate: EsnStepLabel, descendants: true }, { propertyName: "_lazyContent", first: true, predicate: EsnStepContent, descendants: true }], exportAs: ["esnStep"], usesInheritance: true, ngImport: i0, template: "<ng-template>\r\n  <ng-content></ng-content>\r\n  <ng-template [cdkPortalOutlet]=\"_portal\"></ng-template>\r\n</ng-template>\r\n", dependencies: [{ kind: "directive", type: i2.CdkPortalOutlet, selector: "[cdkPortalOutlet]", inputs: ["cdkPortalOutlet"], outputs: ["attached"], exportAs: ["cdkPortalOutlet"] }], changeDetection: i0.ChangeDetectionStrategy.OnPush, encapsulation: i0.ViewEncapsulation.None });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.10", ngImport: i0, type: EsnStep, decorators: [{
            type: Component,
            args: [{ selector: 'esn-step', providers: [
                        { provide: ErrorStateMatcher, useExisting: EsnStep },
                        { provide: CdkStep, useExisting: EsnStep },
                    ], encapsulation: ViewEncapsulation.None, exportAs: 'esnStep', changeDetection: ChangeDetectionStrategy.OnPush, template: "<ng-template>\r\n  <ng-content></ng-content>\r\n  <ng-template [cdkPortalOutlet]=\"_portal\"></ng-template>\r\n</ng-template>\r\n" }]
        }], ctorParameters: function () { return [{ type: EsnStepper, decorators: [{
                    type: Inject,
                    args: [forwardRef(() => EsnStepper)]
                }] }, { type: i1.ErrorStateMatcher, decorators: [{
                    type: SkipSelf
                }] }, { type: i0.ViewContainerRef }, { type: undefined, decorators: [{
                    type: Optional
                }, {
                    type: Inject,
                    args: [STEPPER_GLOBAL_OPTIONS]
                }] }]; }, propDecorators: { stepLabel: [{
                type: ContentChild,
                args: [EsnStepLabel]
            }], esnIcon: [{
                type: Input
            }], _lazyContent: [{
                type: ContentChild,
                args: [EsnStepContent, { static: false }]
            }] } });
export class EsnStepper extends CdkStepper {
    constructor(dir, changeDetectorRef, elementRef, breakpointObserver, cdr) {
        super(dir, changeDetectorRef, elementRef);
        this.breakpointObserver = breakpointObserver;
        this.cdr = cdr;
        /** Steps that belong to the current stepper, excluding ones from nested steppers. */
        this.steps = new QueryList();
        /** Event emitted when the current step is done transitioning in. */
        this.animationDone = new EventEmitter();
        /**
         * Whether the label should display in bottom or end position.
         * Only applies in the `horizontal` orientation.
         */
        this.labelPosition = 'end';
        /**
         * Position of the stepper's header.
         * Only applies in the `horizontal` orientation.
         */
        this.headerPosition = 'top';
        /**
         * Detach the stepper content.
         * Only applies in the `vertical` orientation.
         */
        this.detachContent = false;
        /** Consumer-specified template-refs to be used to override the header icons. */
        this._iconOverrides = {};
        /** Stream of animation `done` events when the body expands/collapses. */
        this._animationDone = new Subject();
        this._animationDuration = '';
        this.onChangeSub = new Subscription();
        this.isMobile = false;
        const nodeName = elementRef.nativeElement.nodeName.toLowerCase();
        this.orientation = nodeName === 'esn-vertical-stepper' ? 'vertical' : 'horizontal';
    }
    /** Duration for the animation. Will be normalized to milliseconds if no units are set. */
    get animationDuration() {
        return this._animationDuration;
    }
    set animationDuration(value) {
        this._animationDuration = /^\d+$/.test(value) ? value + 'ms' : value;
    }
    ngOnInit() {
        // detect screen size changes
        this.onChangeSub.add(this.breakpointObserver.observe([
            `(max-width: ${EsnUtils.BREAKPOINTS.mobile})`
        ]).subscribe((result) => {
            this.isMobile = result.matches;
            this.cdr.detectChanges();
        }));
    }
    ngOnDestroy() {
        this.onChangeSub.unsubscribe();
    }
    ngAfterContentInit() {
        super.ngAfterContentInit();
        this._icons.forEach(({ name, templateRef }) => (this._iconOverrides[name] = templateRef));
        // Mark the component for change detection whenever the content children query changes
        this.steps.changes.pipe(takeUntil(this._destroyed)).subscribe(() => {
            this._stateChanged();
        });
        this._animationDone
            .pipe(
        // This needs a `distinctUntilChanged` in order to avoid emitting the same event twice due
        // to a bug in animations where the `.done` callback gets invoked twice on some browsers.
        // See https://github.com/angular/angular/issues/24084
        distinctUntilChanged((x, y) => x.fromState === y.fromState && x.toState === y.toState), takeUntil(this._destroyed))
            .subscribe(event => {
            if (event.toState === 'current') {
                this.animationDone.emit();
            }
        });
    }
    _stepIsNavigable(index, step) {
        return step.completed || this.selectedIndex === index || !this.linear;
    }
    _getAnimationDuration() {
        if (this.animationDuration) {
            return this.animationDuration;
        }
        return this.orientation === 'horizontal'
            ? DEFAULT_HORIZONTAL_ANIMATION_DURATION
            : DEFAULT_VERTICAL_ANIMATION_DURATION;
    }
}
EsnStepper.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.10", ngImport: i0, type: EsnStepper, deps: [{ token: i3.Directionality, optional: true }, { token: i0.ChangeDetectorRef }, { token: i0.ElementRef }, { token: i4.BreakpointObserver }, { token: i0.ChangeDetectorRef }], target: i0.ɵɵFactoryTarget.Component });
EsnStepper.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.10", type: EsnStepper, selector: "esn-stepper, esn-vertical-stepper, esn-horizontal-stepper, [esnStepper]", inputs: { selectedIndex: "selectedIndex", disableRipple: "disableRipple", labelPosition: "labelPosition", headerPosition: "headerPosition", detachContent: "detachContent", animationDuration: "animationDuration" }, outputs: { animationDone: "animationDone" }, host: { attributes: { "role": "tablist" }, properties: { "class.esn-stepper-horizontal": "orientation === \"horizontal\"", "class.esn-stepper-vertical": "orientation === \"vertical\"", "class.esn-stepper-label-position-end": "orientation === \"horizontal\" && labelPosition == \"end\"", "class.esn-stepper-label-position-bottom": "orientation === \"horizontal\" && labelPosition == \"bottom\"", "class.esn-stepper-header-position-bottom": "headerPosition === \"bottom\"", "attr.aria-orientation": "orientation" } }, providers: [{ provide: CdkStepper, useExisting: EsnStepper }], queries: [{ propertyName: "_steps", predicate: EsnStep, descendants: true }, { propertyName: "_icons", predicate: EsnStepperIcon, descendants: true }], viewQueries: [{ propertyName: "_stepHeader", predicate: EsnStepHeader, descendants: true }], exportAs: ["esnStepper", "esnVerticalStepper", "esnHorizontalStepper"], usesInheritance: true, ngImport: i0, template: "\r\n\r\n\r\n    \r\n  <ng-container *ngIf=\"!isMobile; else mobileVersion\">\r\n    <ng-container [ngSwitch]=\"orientation\">\r\n      <!-- Horizontal stepper -->\r\n      <div class=\"esn-horizontal-stepper-wrapper\" *ngSwitchCase=\"'horizontal'\">\r\n        <div class=\"esn-horizontal-stepper-header-container\">\r\n          <ng-container *ngFor=\"let step of steps; let i = index; let isLast = last\">\r\n            <ng-container\r\n              [ngTemplateOutlet]=\"stepTemplate\"\r\n              [ngTemplateOutletContext]=\"{step: step, i: i}\"></ng-container>\r\n            <div *ngIf=\"!isLast\" class=\"esn-stepper-horizontal-line\"></div>\r\n          </ng-container>\r\n        </div>\r\n  \r\n        <div class=\"esn-horizontal-content-container\">\r\n          <div *ngFor=\"let step of steps; let i = index\"\r\n               class=\"esn-horizontal-stepper-content\" role=\"tabpanel\"\r\n               [@horizontalStepTransition]=\"{\r\n                'value': _getAnimationDirection(i),\r\n                'params': {'animationDuration': _getAnimationDuration()}\r\n              }\"\r\n               (@horizontalStepTransition.done)=\"_animationDone.next($event)\"\r\n               [id]=\"_getStepContentId(i)\"\r\n               [attr.aria-labelledby]=\"_getStepLabelId(i)\"\r\n               [class.esn-horizontal-stepper-content-inactive]=\"selectedIndex !== i\">\r\n            <ng-container [ngTemplateOutlet]=\"step.content\"></ng-container>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <!-- Vertical stepper -->\r\n      <ng-container *ngSwitchCase=\"'vertical'\">\r\n    <!-- Detached content -->\r\n        <div class=\"detached__container\" *ngIf=\"detachContent; else vertical\">\r\n          <div class=\"detached__steps\">\r\n            <div class=\"esn-step\" *ngFor=\"let step of steps; let i = index; let isLast = last\">\r\n              <ng-container\r\n                [ngTemplateOutlet]=\"stepTemplate\"\r\n                [ngTemplateOutletContext]=\"{step: step, i: i}\"></ng-container>\r\n              <div class=\"esn-vertical-content-container\" [class.esn-stepper-vertical-line]=\"!isLast\">\r\n                <div class=\"esn-vertical-stepper-content\" role=\"tabpanel\"\r\n                    [@verticalStepTransition]=\"{\r\n                      'value': _getAnimationDirection(i),\r\n                      'params': {'animationDuration': _getAnimationDuration()}\r\n                    }\"\r\n                    (@verticalStepTransition.done)=\"_animationDone.next($event)\"\r\n                    [id]=\"_getStepContentId(i)\"\r\n                    [attr.aria-labelledby]=\"_getStepLabelId(i)\"\r\n                    [class.esn-vertical-stepper-content-inactive]=\"selectedIndex !== i\">\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"detached__content\">\r\n            <ng-container *ngIf=\"selected\" [ngTemplateOutlet]=\"selected.content\"></ng-container>\r\n          </div>\r\n        </div>\r\n        <ng-template  #vertical>\r\n          <div class=\"esn-step\" *ngFor=\"let step of steps; let i = index; let isLast = last\">\r\n            <ng-container\r\n              [ngTemplateOutlet]=\"stepTemplate\"\r\n              [ngTemplateOutletContext]=\"{step: step, i: i}\"></ng-container>\r\n            <div class=\"esn-vertical-content-container\" [class.esn-stepper-vertical-line]=\"!isLast\">\r\n              <div class=\"esn-vertical-stepper-content\" role=\"tabpanel\"\r\n                   [@verticalStepTransition]=\"{\r\n                    'value': _getAnimationDirection(i),\r\n                    'params': {'animationDuration': _getAnimationDuration()}\r\n                  }\"\r\n                   (@verticalStepTransition.done)=\"_animationDone.next($event)\"\r\n                   [id]=\"_getStepContentId(i)\"\r\n                   [attr.aria-labelledby]=\"_getStepLabelId(i)\"\r\n                   [class.esn-vertical-stepper-content-inactive]=\"selectedIndex !== i\">\r\n                <div class=\"esn-vertical-content\">\r\n                  <ng-container [ngTemplateOutlet]=\"step.content\"></ng-container>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </ng-template>\r\n      </ng-container>\r\n  </ng-container>\r\n    </ng-container>\r\n  \r\n  <!-- Mobile version -->\r\n  <ng-template #mobileVersion>\r\n    <div class=\"esn-step mobile_steps_container\" *ngFor=\"let step of steps; let i = index; let isLast = last\">\r\n      <ng-container *ngIf=\"selectedIndex === i\"\r\n        [ngTemplateOutlet]=\"stepTemplate\"\r\n        [ngTemplateOutletContext]=\"{step: step, i: i}\"></ng-container>\r\n    </div>\r\n    <ng-container *ngIf=\"selected\" [ngTemplateOutlet]=\"selected.content\"></ng-container>\r\n  </ng-template>\r\n\r\n  <!-- Common step templating -->\r\n  <ng-template let-step=\"step\" let-i=\"i\" #stepTemplate>\r\n    <esn-step-header\r\n      [class.esn-horizontal-stepper-header]=\"orientation === 'horizontal'\"\r\n      [class.esn-vertical-stepper-header]=\"orientation === 'vertical'\"\r\n      (click)=\"step.select()\"\r\n      (keydown)=\"_onKeydown($event)\"\r\n      [tabIndex]=\"_getFocusIndex() === i ? 0 : -1\"\r\n      [id]=\"_getStepLabelId(i)\"\r\n      [attr.aria-posinset]=\"i + 1\"\r\n      [attr.aria-setsize]=\"steps.length\"\r\n      [attr.aria-controls]=\"_getStepContentId(i)\"\r\n      [attr.aria-selected]=\"selectedIndex == i\"\r\n      [attr.aria-label]=\"step.ariaLabel || null\"\r\n      [attr.aria-labelledby]=\"(!step.ariaLabel && step.ariaLabelledby) ? step.ariaLabelledby : null\"\r\n      [attr.aria-disabled]=\"_stepIsNavigable(i, step) ? null : true\"\r\n      [index]=\"i\"\r\n      [state]=\"_getIndicatorType(i, step.state)\"\r\n      [label]=\"step.stepLabel || step.label\"\r\n      [selected]=\"selectedIndex === i\"\r\n      [active]=\"_stepIsNavigable(i, step)\"\r\n      [optional]=\"step.optional\"\r\n      [errorMessage]=\"step.errorMessage\"\r\n      [iconOverrides]=\"_iconOverrides\"\r\n      [disableRipple]=\"disableRipple || !_stepIsNavigable(i, step)\"\r\n      [esnIcon]=\"step.esnIcon\"\r\n      [isMobile]=\"isMobile\"\r\n      [stepsNumber]=\"steps?.length\"\r\n    ></esn-step-header>\r\n  </ng-template>", styles: [".esn-stepper-vertical,.esn-stepper-horizontal{display:block}.esn-horizontal-stepper-header-container{white-space:nowrap;display:flex;align-items:center}.esn-stepper-label-position-bottom .esn-horizontal-stepper-header-container{align-items:flex-start}.esn-stepper-header-position-bottom .esn-horizontal-stepper-header-container{order:1}.esn-stepper-horizontal-line{border-top-width:1px;border-top-style:solid;flex:auto;height:0;margin:0 -16px;min-width:32px}.esn-stepper-label-position-bottom .esn-stepper-horizontal-line{margin:0;min-width:0;position:relative}.esn-stepper-label-position-bottom .esn-horizontal-stepper-header:not(:first-child):before,[dir=rtl] .esn-stepper-label-position-bottom .esn-horizontal-stepper-header:not(:last-child):before,.esn-stepper-label-position-bottom .esn-horizontal-stepper-header:not(:last-child):after,[dir=rtl] .esn-stepper-label-position-bottom .esn-horizontal-stepper-header:not(:first-child):after{border-top-width:1px;border-top-style:solid;content:\"\";display:inline-block;height:0;position:absolute;width:calc(50% - 20px)}.esn-horizontal-stepper-header{display:flex;height:72px;overflow:hidden;align-items:center;padding:0 24px}.esn-horizontal-stepper-header .esn-step-icon{margin-right:8px;flex:none}[dir=rtl] .esn-horizontal-stepper-header .esn-step-icon{margin-right:0;margin-left:8px}.esn-stepper-label-position-bottom .esn-horizontal-stepper-header{box-sizing:border-box;flex-direction:column;height:auto}.esn-stepper-label-position-bottom .esn-horizontal-stepper-header:not(:last-child):after,[dir=rtl] .esn-stepper-label-position-bottom .esn-horizontal-stepper-header:not(:first-child):after{right:0}.esn-stepper-label-position-bottom .esn-horizontal-stepper-header:not(:first-child):before,[dir=rtl] .esn-stepper-label-position-bottom .esn-horizontal-stepper-header:not(:last-child):before{left:0}[dir=rtl] .esn-stepper-label-position-bottom .esn-horizontal-stepper-header:last-child:before,[dir=rtl] .esn-stepper-label-position-bottom .esn-horizontal-stepper-header:first-child:after{display:none}.esn-stepper-label-position-bottom .esn-horizontal-stepper-header .esn-step-icon{margin-right:0;margin-left:0}.esn-stepper-label-position-bottom .esn-horizontal-stepper-header .esn-step-label{padding:16px 0 0;text-align:center;width:100%}.esn-vertical-stepper-header{display:flex;align-items:center;height:44px}.esn-vertical-stepper-header .esn-step-icon{margin-right:12px}[dir=rtl] .esn-vertical-stepper-header .esn-step-icon{margin-right:0;margin-left:12px}.esn-horizontal-stepper-wrapper{display:flex;flex-direction:column}.esn-horizontal-stepper-content{outline:0}.esn-horizontal-stepper-content.esn-horizontal-stepper-content-inactive{height:0;overflow:hidden}.esn-horizontal-stepper-content:not(.esn-horizontal-stepper-content-inactive){visibility:inherit!important}.esn-horizontal-content-container{overflow:hidden;padding:0 24px 24px}.cdk-high-contrast-active .esn-horizontal-content-container{outline:solid 1px}.esn-stepper-header-position-bottom .esn-horizontal-content-container{padding:24px 24px 0}.esn-vertical-content-container{margin-left:36px;border:0;position:relative}.cdk-high-contrast-active .esn-vertical-content-container{outline:solid 1px}[dir=rtl] .esn-vertical-content-container{margin-left:0;margin-right:36px}.esn-stepper-vertical-line:before{content:\"\";position:absolute;left:0;border-left-width:1px;border-left-style:solid}[dir=rtl] .esn-stepper-vertical-line:before{left:auto;right:0}.esn-vertical-stepper-content{overflow:hidden;outline:0}.esn-vertical-stepper-content:not(.esn-vertical-stepper-content-inactive){visibility:inherit!important}.esn-vertical-content{padding:0 24px 24px}.esn-step:last-child .esn-vertical-content-container{border:none}.detached__container{display:flex}.detached__content{overflow:hidden;margin-top:.5rem;margin-left:5rem}.mobile_steps_container{margin-bottom:1rem}\n"], dependencies: [{ kind: "directive", type: i5.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i5.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i5.NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet", "ngTemplateOutletInjector"] }, { kind: "directive", type: i5.NgSwitch, selector: "[ngSwitch]", inputs: ["ngSwitch"] }, { kind: "directive", type: i5.NgSwitchCase, selector: "[ngSwitchCase]", inputs: ["ngSwitchCase"] }, { kind: "component", type: i6.EsnStepHeader, selector: "esn-step-header", inputs: ["state", "label", "errorMessage", "iconOverrides", "index", "selected", "active", "optional", "disableRipple", "esnIcon", "isMobile", "stepsNumber"] }], animations: [
        esnStepperAnimations.horizontalStepTransition,
        esnStepperAnimations.verticalStepTransition,
    ], changeDetection: i0.ChangeDetectionStrategy.OnPush, encapsulation: i0.ViewEncapsulation.None });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.10", ngImport: i0, type: EsnStepper, decorators: [{
            type: Component,
            args: [{ selector: 'esn-stepper, esn-vertical-stepper, esn-horizontal-stepper, [esnStepper]', exportAs: 'esnStepper, esnVerticalStepper, esnHorizontalStepper', inputs: ['selectedIndex'], host: {
                        '[class.esn-stepper-horizontal]': 'orientation === "horizontal"',
                        '[class.esn-stepper-vertical]': 'orientation === "vertical"',
                        '[class.esn-stepper-label-position-end]': 'orientation === "horizontal" && labelPosition == "end"',
                        '[class.esn-stepper-label-position-bottom]': 'orientation === "horizontal" && labelPosition == "bottom"',
                        '[class.esn-stepper-header-position-bottom]': 'headerPosition === "bottom"',
                        '[attr.aria-orientation]': 'orientation',
                        'role': 'tablist',
                    }, animations: [
                        esnStepperAnimations.horizontalStepTransition,
                        esnStepperAnimations.verticalStepTransition,
                    ], providers: [{ provide: CdkStepper, useExisting: EsnStepper }], encapsulation: ViewEncapsulation.None, changeDetection: ChangeDetectionStrategy.OnPush, template: "\r\n\r\n\r\n    \r\n  <ng-container *ngIf=\"!isMobile; else mobileVersion\">\r\n    <ng-container [ngSwitch]=\"orientation\">\r\n      <!-- Horizontal stepper -->\r\n      <div class=\"esn-horizontal-stepper-wrapper\" *ngSwitchCase=\"'horizontal'\">\r\n        <div class=\"esn-horizontal-stepper-header-container\">\r\n          <ng-container *ngFor=\"let step of steps; let i = index; let isLast = last\">\r\n            <ng-container\r\n              [ngTemplateOutlet]=\"stepTemplate\"\r\n              [ngTemplateOutletContext]=\"{step: step, i: i}\"></ng-container>\r\n            <div *ngIf=\"!isLast\" class=\"esn-stepper-horizontal-line\"></div>\r\n          </ng-container>\r\n        </div>\r\n  \r\n        <div class=\"esn-horizontal-content-container\">\r\n          <div *ngFor=\"let step of steps; let i = index\"\r\n               class=\"esn-horizontal-stepper-content\" role=\"tabpanel\"\r\n               [@horizontalStepTransition]=\"{\r\n                'value': _getAnimationDirection(i),\r\n                'params': {'animationDuration': _getAnimationDuration()}\r\n              }\"\r\n               (@horizontalStepTransition.done)=\"_animationDone.next($event)\"\r\n               [id]=\"_getStepContentId(i)\"\r\n               [attr.aria-labelledby]=\"_getStepLabelId(i)\"\r\n               [class.esn-horizontal-stepper-content-inactive]=\"selectedIndex !== i\">\r\n            <ng-container [ngTemplateOutlet]=\"step.content\"></ng-container>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <!-- Vertical stepper -->\r\n      <ng-container *ngSwitchCase=\"'vertical'\">\r\n    <!-- Detached content -->\r\n        <div class=\"detached__container\" *ngIf=\"detachContent; else vertical\">\r\n          <div class=\"detached__steps\">\r\n            <div class=\"esn-step\" *ngFor=\"let step of steps; let i = index; let isLast = last\">\r\n              <ng-container\r\n                [ngTemplateOutlet]=\"stepTemplate\"\r\n                [ngTemplateOutletContext]=\"{step: step, i: i}\"></ng-container>\r\n              <div class=\"esn-vertical-content-container\" [class.esn-stepper-vertical-line]=\"!isLast\">\r\n                <div class=\"esn-vertical-stepper-content\" role=\"tabpanel\"\r\n                    [@verticalStepTransition]=\"{\r\n                      'value': _getAnimationDirection(i),\r\n                      'params': {'animationDuration': _getAnimationDuration()}\r\n                    }\"\r\n                    (@verticalStepTransition.done)=\"_animationDone.next($event)\"\r\n                    [id]=\"_getStepContentId(i)\"\r\n                    [attr.aria-labelledby]=\"_getStepLabelId(i)\"\r\n                    [class.esn-vertical-stepper-content-inactive]=\"selectedIndex !== i\">\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"detached__content\">\r\n            <ng-container *ngIf=\"selected\" [ngTemplateOutlet]=\"selected.content\"></ng-container>\r\n          </div>\r\n        </div>\r\n        <ng-template  #vertical>\r\n          <div class=\"esn-step\" *ngFor=\"let step of steps; let i = index; let isLast = last\">\r\n            <ng-container\r\n              [ngTemplateOutlet]=\"stepTemplate\"\r\n              [ngTemplateOutletContext]=\"{step: step, i: i}\"></ng-container>\r\n            <div class=\"esn-vertical-content-container\" [class.esn-stepper-vertical-line]=\"!isLast\">\r\n              <div class=\"esn-vertical-stepper-content\" role=\"tabpanel\"\r\n                   [@verticalStepTransition]=\"{\r\n                    'value': _getAnimationDirection(i),\r\n                    'params': {'animationDuration': _getAnimationDuration()}\r\n                  }\"\r\n                   (@verticalStepTransition.done)=\"_animationDone.next($event)\"\r\n                   [id]=\"_getStepContentId(i)\"\r\n                   [attr.aria-labelledby]=\"_getStepLabelId(i)\"\r\n                   [class.esn-vertical-stepper-content-inactive]=\"selectedIndex !== i\">\r\n                <div class=\"esn-vertical-content\">\r\n                  <ng-container [ngTemplateOutlet]=\"step.content\"></ng-container>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </ng-template>\r\n      </ng-container>\r\n  </ng-container>\r\n    </ng-container>\r\n  \r\n  <!-- Mobile version -->\r\n  <ng-template #mobileVersion>\r\n    <div class=\"esn-step mobile_steps_container\" *ngFor=\"let step of steps; let i = index; let isLast = last\">\r\n      <ng-container *ngIf=\"selectedIndex === i\"\r\n        [ngTemplateOutlet]=\"stepTemplate\"\r\n        [ngTemplateOutletContext]=\"{step: step, i: i}\"></ng-container>\r\n    </div>\r\n    <ng-container *ngIf=\"selected\" [ngTemplateOutlet]=\"selected.content\"></ng-container>\r\n  </ng-template>\r\n\r\n  <!-- Common step templating -->\r\n  <ng-template let-step=\"step\" let-i=\"i\" #stepTemplate>\r\n    <esn-step-header\r\n      [class.esn-horizontal-stepper-header]=\"orientation === 'horizontal'\"\r\n      [class.esn-vertical-stepper-header]=\"orientation === 'vertical'\"\r\n      (click)=\"step.select()\"\r\n      (keydown)=\"_onKeydown($event)\"\r\n      [tabIndex]=\"_getFocusIndex() === i ? 0 : -1\"\r\n      [id]=\"_getStepLabelId(i)\"\r\n      [attr.aria-posinset]=\"i + 1\"\r\n      [attr.aria-setsize]=\"steps.length\"\r\n      [attr.aria-controls]=\"_getStepContentId(i)\"\r\n      [attr.aria-selected]=\"selectedIndex == i\"\r\n      [attr.aria-label]=\"step.ariaLabel || null\"\r\n      [attr.aria-labelledby]=\"(!step.ariaLabel && step.ariaLabelledby) ? step.ariaLabelledby : null\"\r\n      [attr.aria-disabled]=\"_stepIsNavigable(i, step) ? null : true\"\r\n      [index]=\"i\"\r\n      [state]=\"_getIndicatorType(i, step.state)\"\r\n      [label]=\"step.stepLabel || step.label\"\r\n      [selected]=\"selectedIndex === i\"\r\n      [active]=\"_stepIsNavigable(i, step)\"\r\n      [optional]=\"step.optional\"\r\n      [errorMessage]=\"step.errorMessage\"\r\n      [iconOverrides]=\"_iconOverrides\"\r\n      [disableRipple]=\"disableRipple || !_stepIsNavigable(i, step)\"\r\n      [esnIcon]=\"step.esnIcon\"\r\n      [isMobile]=\"isMobile\"\r\n      [stepsNumber]=\"steps?.length\"\r\n    ></esn-step-header>\r\n  </ng-template>", styles: [".esn-stepper-vertical,.esn-stepper-horizontal{display:block}.esn-horizontal-stepper-header-container{white-space:nowrap;display:flex;align-items:center}.esn-stepper-label-position-bottom .esn-horizontal-stepper-header-container{align-items:flex-start}.esn-stepper-header-position-bottom .esn-horizontal-stepper-header-container{order:1}.esn-stepper-horizontal-line{border-top-width:1px;border-top-style:solid;flex:auto;height:0;margin:0 -16px;min-width:32px}.esn-stepper-label-position-bottom .esn-stepper-horizontal-line{margin:0;min-width:0;position:relative}.esn-stepper-label-position-bottom .esn-horizontal-stepper-header:not(:first-child):before,[dir=rtl] .esn-stepper-label-position-bottom .esn-horizontal-stepper-header:not(:last-child):before,.esn-stepper-label-position-bottom .esn-horizontal-stepper-header:not(:last-child):after,[dir=rtl] .esn-stepper-label-position-bottom .esn-horizontal-stepper-header:not(:first-child):after{border-top-width:1px;border-top-style:solid;content:\"\";display:inline-block;height:0;position:absolute;width:calc(50% - 20px)}.esn-horizontal-stepper-header{display:flex;height:72px;overflow:hidden;align-items:center;padding:0 24px}.esn-horizontal-stepper-header .esn-step-icon{margin-right:8px;flex:none}[dir=rtl] .esn-horizontal-stepper-header .esn-step-icon{margin-right:0;margin-left:8px}.esn-stepper-label-position-bottom .esn-horizontal-stepper-header{box-sizing:border-box;flex-direction:column;height:auto}.esn-stepper-label-position-bottom .esn-horizontal-stepper-header:not(:last-child):after,[dir=rtl] .esn-stepper-label-position-bottom .esn-horizontal-stepper-header:not(:first-child):after{right:0}.esn-stepper-label-position-bottom .esn-horizontal-stepper-header:not(:first-child):before,[dir=rtl] .esn-stepper-label-position-bottom .esn-horizontal-stepper-header:not(:last-child):before{left:0}[dir=rtl] .esn-stepper-label-position-bottom .esn-horizontal-stepper-header:last-child:before,[dir=rtl] .esn-stepper-label-position-bottom .esn-horizontal-stepper-header:first-child:after{display:none}.esn-stepper-label-position-bottom .esn-horizontal-stepper-header .esn-step-icon{margin-right:0;margin-left:0}.esn-stepper-label-position-bottom .esn-horizontal-stepper-header .esn-step-label{padding:16px 0 0;text-align:center;width:100%}.esn-vertical-stepper-header{display:flex;align-items:center;height:44px}.esn-vertical-stepper-header .esn-step-icon{margin-right:12px}[dir=rtl] .esn-vertical-stepper-header .esn-step-icon{margin-right:0;margin-left:12px}.esn-horizontal-stepper-wrapper{display:flex;flex-direction:column}.esn-horizontal-stepper-content{outline:0}.esn-horizontal-stepper-content.esn-horizontal-stepper-content-inactive{height:0;overflow:hidden}.esn-horizontal-stepper-content:not(.esn-horizontal-stepper-content-inactive){visibility:inherit!important}.esn-horizontal-content-container{overflow:hidden;padding:0 24px 24px}.cdk-high-contrast-active .esn-horizontal-content-container{outline:solid 1px}.esn-stepper-header-position-bottom .esn-horizontal-content-container{padding:24px 24px 0}.esn-vertical-content-container{margin-left:36px;border:0;position:relative}.cdk-high-contrast-active .esn-vertical-content-container{outline:solid 1px}[dir=rtl] .esn-vertical-content-container{margin-left:0;margin-right:36px}.esn-stepper-vertical-line:before{content:\"\";position:absolute;left:0;border-left-width:1px;border-left-style:solid}[dir=rtl] .esn-stepper-vertical-line:before{left:auto;right:0}.esn-vertical-stepper-content{overflow:hidden;outline:0}.esn-vertical-stepper-content:not(.esn-vertical-stepper-content-inactive){visibility:inherit!important}.esn-vertical-content{padding:0 24px 24px}.esn-step:last-child .esn-vertical-content-container{border:none}.detached__container{display:flex}.detached__content{overflow:hidden;margin-top:.5rem;margin-left:5rem}.mobile_steps_container{margin-bottom:1rem}\n"] }]
        }], ctorParameters: function () { return [{ type: i3.Directionality, decorators: [{
                    type: Optional
                }] }, { type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: i4.BreakpointObserver }, { type: i0.ChangeDetectorRef }]; }, propDecorators: { _stepHeader: [{
                type: ViewChildren,
                args: [EsnStepHeader]
            }], _steps: [{
                type: ContentChildren,
                args: [EsnStep, { descendants: true }]
            }], _icons: [{
                type: ContentChildren,
                args: [EsnStepperIcon, { descendants: true }]
            }], animationDone: [{
                type: Output
            }], disableRipple: [{
                type: Input
            }], labelPosition: [{
                type: Input
            }], headerPosition: [{
                type: Input
            }], detachContent: [{
                type: Input
            }], animationDuration: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RlcHBlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2Fyb20tZG9tYWluLWlwbm4tYzkwLWRlc2lnbi1saWIvc3JjL2xpYi9jb21wb25lbnRzL3N0ZXBwZXIvc3RlcHBlci50cyIsIi4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2Fyb20tZG9tYWluLWlwbm4tYzkwLWRlc2lnbi1saWIvc3JjL2xpYi9jb21wb25lbnRzL3N0ZXBwZXIvc3RlcC5odG1sIiwiLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvYXJvbS1kb21haW4taXBubi1jOTAtZGVzaWduLWxpYi9zcmMvbGliL2NvbXBvbmVudHMvc3RlcHBlci9zdGVwcGVyLmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBU0EsT0FBTyxFQUNMLE9BQU8sRUFDUCxVQUFVLEVBRVYsc0JBQXNCLEdBRXZCLE1BQU0sc0JBQXNCLENBQUM7QUFFOUIsT0FBTyxFQUVMLHVCQUF1QixFQUV2QixTQUFTLEVBQ1QsWUFBWSxFQUNaLGVBQWUsRUFFZixZQUFZLEVBQ1osVUFBVSxFQUNWLE1BQU0sRUFDTixLQUFLLEVBRUwsUUFBUSxFQUNSLE1BQU0sRUFDTixTQUFTLEVBQ1QsUUFBUSxFQUVSLFlBQVksRUFFWixpQkFBaUIsR0FDbEIsTUFBTSxlQUFlLENBQUM7QUFFdkIsT0FBTyxFQUFDLGlCQUFpQixFQUFlLE1BQU0sd0JBQXdCLENBQUM7QUFDdkUsT0FBTyxFQUFDLGNBQWMsRUFBQyxNQUFNLHFCQUFxQixDQUFDO0FBQ25ELE9BQU8sRUFBQyxPQUFPLEVBQUUsWUFBWSxFQUFDLE1BQU0sTUFBTSxDQUFDO0FBQzNDLE9BQU8sRUFBQyxTQUFTLEVBQUUsb0JBQW9CLEVBQUUsR0FBRyxFQUFFLFNBQVMsRUFBRSxTQUFTLEVBQUMsTUFBTSxnQkFBZ0IsQ0FBQztBQUUxRixPQUFPLEVBQUMsYUFBYSxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBQzVDLE9BQU8s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QkFBaUI7c0JBRHBCLEtBQUsiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IEdvb2dsZSBMTEMgQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICpcclxuICogVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYW4gTUlULXN0eWxlIGxpY2Vuc2UgdGhhdCBjYW4gYmVcclxuICogZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBhdCBodHRwczovL2FuZ3VsYXIuaW8vbGljZW5zZVxyXG4gKi9cclxuXHJcbmltcG9ydCB7RGlyZWN0aW9uYWxpdHl9IGZyb20gJ0Bhbmd1bGFyL2Nkay9iaWRpJztcclxuaW1wb3J0IHtcclxuICBDZGtTdGVwLFxyXG4gIENka1N0ZXBwZXIsXHJcbiAgU3RlcENvbnRlbnRQb3NpdGlvblN0YXRlLFxyXG4gIFNURVBQRVJfR0xPQkFMX09QVElPTlMsXHJcbiAgU3RlcHBlck9wdGlvbnMsXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY2RrL3N0ZXBwZXInO1xyXG5pbXBvcnQge0FuaW1hdGlvbkV2ZW50fSBmcm9tICdAYW5ndWxhci9hbmltYXRpb25zJztcclxuaW1wb3J0IHtcclxuICBBZnRlckNvbnRlbnRJbml0LFxyXG4gIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LFxyXG4gIENoYW5nZURldGVjdG9yUmVmLFxyXG4gIENvbXBvbmVudCxcclxuICBDb250ZW50Q2hpbGQsXHJcbiAgQ29udGVudENoaWxkcmVuLFxyXG4gIEVsZW1lbnRSZWYsXHJcbiAgRXZlbnRFbWl0dGVyLFxyXG4gIGZvcndhcmRSZWYsXHJcbiAgSW5qZWN0LFxyXG4gIElucHV0LFxyXG4gIE9uRGVzdHJveSwgT25Jbml0LFxyXG4gIE9wdGlvbmFsLFxyXG4gIE91dHB1dCxcclxuICBRdWVyeUxpc3QsXHJcbiAgU2tpcFNlbGYsXHJcbiAgVGVtcGxhdGVSZWYsXHJcbiAgVmlld0NoaWxkcmVuLFxyXG4gIFZpZXdDb250YWluZXJSZWYsXHJcbiAgVmlld0VuY2Fwc3VsYXRpb24sXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7QWJzdHJhY3RDb250cm9sLCBGb3JtR3JvdXBEaXJlY3RpdmUsIE5nRm9ybX0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xyXG5pbXBvcnQge0Vycm9yU3RhdGVNYXRjaGVyLCBUaGVtZVBhbGV0dGV9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsL2NvcmUnO1xyXG5pbXBvcnQge1RlbXBsYXRlUG9ydGFsfSBmcm9tICdAYW5ndWxhci9jZGsvcG9ydGFsJztcclxuaW1wb3J0IHtTdWJqZWN0LCBTdWJzY3JpcHRpb259IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQge3Rha2VVbnRpbCwgZGlzdGluY3RVbnRpbENoYW5nZWQsIG1hcCwgc3RhcnRXaXRoLCBzd2l0Y2hNYXB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuXHJcbmltcG9ydCB7RXNuU3RlcEhlYWRlcn0gZnJvbSAnLi9zdGVwLWhlYWRlcic7XHJcbmltcG9ydCB7RXNuU3RlcExhYmVsfSBmcm9tICcuL3N0ZXAtbGFiZWwnO1xyXG5pbXBvcnQge1xyXG4gIERFRkFVTFRfSE9SSVpPTlRBTF9BTklNQVRJT05fRFVSQVRJT04sXHJcbiAgREVGQVVMVF9WRVJUSUNBTF9BTklNQVRJT05fRFVSQVRJT04sXHJcbiAgZXNuU3RlcHBlckFuaW1hdGlvbnMsXHJcbn0gZnJvbSAnLi9zdGVwcGVyLWFuaW1hdGlvbnMnO1xyXG5pbXBvcnQge0VzblN0ZXBwZXJJY29uLCBFc25TdGVwcGVySWNvbkNvbnRleHR9IGZyb20gJy4vc3RlcHBlci1pY29uJztcclxuaW1wb3J0IHtFc25TdGVwQ29udGVudH0gZnJvbSAnLi9zdGVwLWNvbnRlbnQnO1xyXG5pbXBvcnQge0Vzbkljb25OYW1lfSBmcm9tIFwiLi4vaWNvbi9pY29uc1wiO1xyXG5pbXBvcnQge0JyZWFrcG9pbnRPYnNlcnZlciwgQnJlYWtwb2ludFN0YXRlfSBmcm9tIFwiQGFuZ3VsYXIvY2RrL2xheW91dFwiO1xyXG5pbXBvcnQgeyBFc25VdGlscyB9IGZyb20gJy4uLy4uL3V0aWxzL3B1YmxpYy1hcGknO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdlc24tc3RlcCcsXHJcbiAgdGVtcGxhdGVVcmw6ICdzdGVwLmh0bWwnLFxyXG4gIHByb3ZpZGVyczogW1xyXG4gICAge3Byb3ZpZGU6IEVycm9yU3RhdGVNYXRjaGVyLCB1c2VFeGlzdGluZzogRXNuU3RlcH0sXHJcbiAgICB7cHJvdmlkZTogQ2RrU3RlcCwgdXNlRXhpc3Rpbmc6IEVzblN0ZXB9LFxyXG4gIF0sXHJcbiAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZSxcclxuICBleHBvcnRBczogJ2VzblN0ZXAnLFxyXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxyXG59KVxyXG5leHBvcnQgY2xhc3MgRXNuU3RlcCBleHRlbmRzIENka1N0ZXAgaW1wbGVtZW50cyBFcnJvclN0YXRlTWF0Y2hlciwgQWZ0ZXJDb250ZW50SW5pdCwgT25EZXN0cm95IHtcclxuICBwcml2YXRlIF9pc1NlbGVjdGVkID0gU3Vic2NyaXB0aW9uLkVNUFRZO1xyXG5cclxuICAvKiogQ29udGVudCBmb3Igc3RlcCBsYWJlbCBnaXZlbiBieSBgPG5nLXRlbXBsYXRlIGVzblN0ZXBMYWJlbD5gLiAqL1xyXG4gIEBDb250ZW50Q2hpbGQoRXNuU3RlcExhYmVsKSBvdmVycmlkZSBzdGVwTGFiZWw6IEVzblN0ZXBMYWJlbDtcclxuXHJcbiAgLyoqIEVzbiBJY29ucyAqL1xyXG4gIEBJbnB1dCgpIGVzbkljb246IEVzbkljb25OYW1lO1xyXG5cclxuICAvKiogQ29udGVudCB0aGF0IHdpbGwgYmUgcmVuZGVyZWQgbGF6aWx5LiAqL1xyXG4gIEBDb250ZW50Q2hpbGQoRXNuU3RlcENvbnRlbnQsIHtzdGF0aWM6IGZhbHNlfSkgX2xhenlDb250ZW50OiBFc25TdGVwQ29udGVudDtcclxuXHJcbiAgLyoqIEN1cnJlbnRseS1hdHRhY2hlZCBwb3J0YWwgY29udGFpbmluZyB0aGUgbGF6eSBjb250ZW50LiAqL1xyXG4gIF9wb3J0YWw6IFRlbXBsYXRlUG9ydGFsO1xyXG5cclxuICBjb25zdHJ1Y3RvcihcclxuICAgIEBJbmplY3QoZm9yd2FyZFJlZigoKSA9PiBFc25TdGVwcGVyKSkgc3RlcHBlcjogRXNuU3RlcHBlcixcclxuICAgIEBTa2lwU2VsZigpIHByaXZhdGUgX2Vycm9yU3RhdGVNYXRjaGVyOiBFcnJvclN0YXRlTWF0Y2hlcixcclxuICAgIHByaXZhdGUgX3ZpZXdDb250YWluZXJSZWY6IFZpZXdDb250YWluZXJSZWYsXHJcbiAgICBAT3B0aW9uYWwoKSBASW5qZWN0KFNURVBQRVJfR0xPQkFMX09QVElPTlMpIHN0ZXBwZXJPcHRpb25zPzogU3RlcHBlck9wdGlvbnMsXHJcbiAgKSB7XHJcbiAgICBzdXBlcihzdGVwcGVyLCBzdGVwcGVyT3B0aW9ucyk7XHJcbiAgfVxyXG5cclxuICBuZ0FmdGVyQ29udGVudEluaXQoKSB7XHJcbiAgICB0aGlzLl9pc1NlbGVjdGVkID0gdGhpcy5fc3RlcHBlci5zdGVwcy5jaGFuZ2VzXHJcbiAgICAgIC5waXBlKFxyXG4gICAgICAgIHN3aXRjaE1hcCgoKSA9PiB7XHJcbiAgICAgICAgICByZXR1cm4gdGhpcy5fc3RlcHBlci5zZWxlY3Rpb25DaGFuZ2UucGlwZShcclxuICAgICAgICAgICAgbWFwKGV2ZW50ID0+IGV2ZW50LnNlbGVjdGVkU3RlcCA9PT0gdGhpcyksXHJcbiAgICAgICAgICAgIHN0YXJ0V2l0aCh0aGlzLl9zdGVwcGVyLnNlbGVjdGVkID09PSB0aGlzKSxcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgfSksXHJcbiAgICAgIClcclxuICAgICAgLnN1YnNjcmliZShpc1NlbGVjdGVkID0+IHtcclxuICAgICAgICBpZiAoaXNTZWxlY3RlZCAmJiB0aGlzLl9sYXp5Q29udGVudCAmJiAhdGhpcy5fcG9ydGFsKSB7XHJcbiAgICAgICAgICB0aGlzLl9wb3J0YWwgPSBuZXcgVGVtcGxhdGVQb3J0YWwodGhpcy5fbGF6eUNvbnRlbnQuX3RlbXBsYXRlLCB0aGlzLl92aWV3Q29udGFpbmVyUmVmISk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIG5nT25EZXN0cm95KCkge1xyXG4gICAgdGhpcy5faXNTZWxlY3RlZC51bnN1YnNjcmliZSgpO1xyXG4gIH1cclxuXHJcbiAgLyoqIEN1c3RvbSBlcnJvciBzdGF0ZSBtYXRjaGVyIHRoYXQgYWRkaXRpb25hbGx5IGNoZWNrcyBmb3IgdmFsaWRpdHkgb2YgaW50ZXJhY3RlZCBmb3JtLiAqL1xyXG4gIGlzRXJyb3JTdGF0ZShjb250cm9sOiBBYnN0cmFjdENvbnRyb2wgfCBudWxsLCBmb3JtOiBGb3JtR3JvdXBEaXJlY3RpdmUgfCBOZ0Zvcm0gfCBudWxsKTogYm9vbGVhbiB7XHJcbiAgICBjb25zdCBvcmlnaW5hbEVycm9yU3RhdGUgPSB0aGlzLl9lcnJvclN0YXRlTWF0Y2hlci5pc0Vycm9yU3RhdGUoY29udHJvbCwgZm9ybSk7XHJcblxyXG4gICAgLy8gQ3VzdG9tIGVycm9yIHN0YXRlIGNoZWNrcyBmb3IgdGhlIHZhbGlkaXR5IG9mIGZvcm0gdGhhdCBpcyBub3Qgc3VibWl0dGVkIG9yIHRvdWNoZWRcclxuICAgIC8vIHNpbmNlIHVzZXIgY2FuIHRyaWdnZXIgYSBmb3JtIGNoYW5nZSBieSBjYWxsaW5nIGZvciBhbm90aGVyIHN0ZXAgd2l0aG91dCBkaXJlY3RseVxyXG4gICAgLy8gaW50ZXJhY3Rpbmcgd2l0aCB0aGUgY3VycmVudCBmb3JtLlxyXG4gICAgY29uc3QgY3VzdG9tRXJyb3JTdGF0ZSA9ICEhKGNvbnRyb2wgJiYgY29udHJvbC5pbnZhbGlkICYmIHRoaXMuaW50ZXJhY3RlZCk7XHJcblxyXG4gICAgcmV0dXJuIG9yaWdpbmFsRXJyb3JTdGF0ZSB8fCBjdXN0b21FcnJvclN0YXRlO1xyXG4gIH1cclxufVxyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdlc24tc3RlcHBlciwgZXNuLXZlcnRpY2FsLXN0ZXBwZXIsIGVzbi1ob3Jpem9udGFsLXN0ZXBwZXIsIFtlc25TdGVwcGVyXScsXHJcbiAgZXhwb3J0QXM6ICdlc25TdGVwcGVyLCBlc25WZXJ0aWNhbFN0ZXBwZXIsIGVzbkhvcml6b250YWxTdGVwcGVyJyxcclxuICB0ZW1wbGF0ZVVybDogJ3N0ZXBwZXIuaHRtbCcsXHJcbiAgc3R5bGVVcmxzOiBbJ3N0ZXBwZXIuc2NzcyddLFxyXG4gIGlucHV0czogWydzZWxlY3RlZEluZGV4J10sXHJcbiAgaG9zdDoge1xyXG4gICAgJ1tjbGFzcy5lc24tc3RlcHBlci1ob3Jpem9udGFsXSc6ICdvcmllbnRhdGlvbiA9PT0gXCJob3Jpem9udGFsXCInLFxyXG4gICAgJ1tjbGFzcy5lc24tc3RlcHBlci12ZXJ0aWNhbF0nOiAnb3JpZW50YXRpb24gPT09IFwidmVydGljYWxcIicsXHJcbiAgICAnW2NsYXNzLmVzbi1zdGVwcGVyLWxhYmVsLXBvc2l0aW9uLWVuZF0nOlxyXG4gICAgICAnb3JpZW50YXRpb24gPT09IFwiaG9yaXpvbnRhbFwiICYmIGxhYmVsUG9zaXRpb24gPT0gXCJlbmRcIicsXHJcbiAgICAnW2NsYXNzLmVzbi1zdGVwcGVyLWxhYmVsLXBvc2l0aW9uLWJvdHRvbV0nOlxyXG4gICAgICAnb3JpZW50YXRpb24gPT09IFwiaG9yaXpvbnRhbFwiICYmIGxhYmVsUG9zaXRpb24gPT0gXCJib3R0b21cIicsXHJcbiAgICAnW2NsYXNzLmVzbi1zdGVwcGVyLWhlYWRlci1wb3NpdGlvbi1ib3R0b21dJzogJ2hlYWRlclBvc2l0aW9uID09PSBcImJvdHRvbVwiJyxcclxuICAgICdbYXR0ci5hcmlhLW9yaWVudGF0aW9uXSc6ICdvcmllbnRhdGlvbicsXHJcbiAgICAncm9sZSc6ICd0YWJsaXN0JyxcclxuICB9LFxyXG4gIGFuaW1hdGlvbnM6IFtcclxuICAgIGVzblN0ZXBwZXJBbmltYXRpb25zLmhvcml6b250YWxTdGVwVHJhbnNpdGlvbixcclxuICAgIGVzblN0ZXBwZXJBbmltYXRpb25zLnZlcnRpY2FsU3RlcFRyYW5zaXRpb24sXHJcbiAgXSxcclxuICBwcm92aWRlcnM6IFt7cHJvdmlkZTogQ2RrU3RlcHBlciwgdXNlRXhpc3Rpbmc6IEVzblN0ZXBwZXJ9XSxcclxuICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lLFxyXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxyXG59KVxyXG5leHBvcnQgY2xhc3MgRXNuU3RlcHBlciBleHRlbmRzIENka1N0ZXBwZXIgaW1wbGVtZW50cyBBZnRlckNvbnRlbnRJbml0LCBPbkluaXQsIE9uRGVzdHJveSB7XHJcbiAgLyoqIFRoZSBsaXN0IG9mIHN0ZXAgaGVhZGVycyBvZiB0aGUgc3RlcHMgaW4gdGhlIHN0ZXBwZXIuICovXHJcbiAgQFZpZXdDaGlsZHJlbihFc25TdGVwSGVhZGVyKSBvdmVycmlkZSBfc3RlcEhlYWRlcjogUXVlcnlMaXN0PEVzblN0ZXBIZWFkZXI+O1xyXG5cclxuICAvKiogRnVsbCBsaXN0IG9mIHN0ZXBzIGluc2lkZSB0aGUgc3RlcHBlciwgaW5jbHVkaW5nIGluc2lkZSBuZXN0ZWQgc3RlcHBlcnMuICovXHJcbiAgQENvbnRlbnRDaGlsZHJlbihFc25TdGVwLCB7ZGVzY2VuZGFudHM6IHRydWV9KSBvdmVycmlkZSBfc3RlcHM6IFF1ZXJ5TGlzdDxFc25TdGVwPjtcclxuXHJcbiAgLyoqIFN0ZXBzIHRoYXQgYmVsb25nIHRvIHRoZSBjdXJyZW50IHN0ZXBwZXIsIGV4Y2x1ZGluZyBvbmVzIGZyb20gbmVzdGVkIHN0ZXBwZXJzLiAqL1xyXG4gIG92ZXJyaWRlIHJlYWRvbmx5IHN0ZXBzOiBRdWVyeUxpc3Q8RXNuU3RlcD4gPSBuZXcgUXVlcnlMaXN0PEVzblN0ZXA+KCk7XHJcblxyXG4gIC8qKiBDdXN0b20gaWNvbiBvdmVycmlkZXMgcGFzc2VkIGluIGJ5IHRoZSBjb25zdW1lci4gKi9cclxuICBAQ29udGVudENoaWxkcmVuKEVzblN0ZXBwZXJJY29uLCB7ZGVzY2VuZGFudHM6IHRydWV9KSBfaWNvbnM6IFF1ZXJ5TGlzdDxFc25TdGVwcGVySWNvbj47XHJcblxyXG4gIC8qKiBFdmVudCBlbWl0dGVkIHdoZW4gdGhlIGN1cnJlbnQgc3RlcCBpcyBkb25lIHRyYW5zaXRpb25pbmcgaW4uICovXHJcbiAgQE91dHB1dCgpIHJlYWRvbmx5IGFuaW1hdGlvbkRvbmU6IEV2ZW50RW1pdHRlcjx2b2lkPiA9IG5ldyBFdmVudEVtaXR0ZXI8dm9pZD4oKTtcclxuXHJcbiAgLyoqIFdoZXRoZXIgcmlwcGxlcyBzaG91bGQgYmUgZGlzYWJsZWQgZm9yIHRoZSBzdGVwIGhlYWRlcnMuICovXHJcbiAgQElucHV0KCkgZGlzYWJsZVJpcHBsZTogYm9vbGVhbjtcclxuXHJcbiAgLyoqXHJcbiAgICogV2hldGhlciB0aGUgbGFiZWwgc2hvdWxkIGRpc3BsYXkgaW4gYm90dG9tIG9yIGVuZCBwb3NpdGlvbi5cclxuICAgKiBPbmx5IGFwcGxpZXMgaW4gdGhlIGBob3Jpem9udGFsYCBvcmllbnRhdGlvbi5cclxuICAgKi9cclxuICBASW5wdXQoKVxyXG4gIGxhYmVsUG9zaXRpb246ICdib3R0b20nIHwgJ2VuZCcgPSAnZW5kJztcclxuXHJcbiAgLyoqXHJcbiAgICogUG9zaXRpb24gb2YgdGhlIHN0ZXBwZXIncyBoZWFkZXIuXHJcbiAgICogT25seSBhcHBsaWVzIGluIHRoZSBgaG9yaXpvbnRhbGAgb3JpZW50YXRpb24uXHJcbiAgICovXHJcbiAgQElucHV0KClcclxuICBoZWFkZXJQb3NpdGlvbjogJ3RvcCcgfCAnYm90dG9tJyA9ICd0b3AnO1xyXG5cclxuICAvKipcclxuICAgKiBEZXRhY2ggdGhlIHN0ZXBwZXIgY29udGVudC5cclxuICAgKiBPbmx5IGFwcGxpZXMgaW4gdGhlIGB2ZXJ0aWNhbGAgb3JpZW50YXRpb24uXHJcbiAgICovXHJcbiAgQElucHV0KClcclxuICBkZXRhY2hDb250ZW50OiBib29sZWFuID0gZmFsc2U7XHJcblxyXG4gIC8qKiBDb25zdW1lci1zcGVjaWZpZWQgdGVtcGxhdGUtcmVmcyB0byBiZSB1c2VkIHRvIG92ZXJyaWRlIHRoZSBoZWFkZXIgaWNvbnMuICovXHJcbiAgX2ljb25PdmVycmlkZXM6IFJlY29yZDxzdHJpbmcsIFRlbXBsYXRlUmVmPEVzblN0ZXBwZXJJY29uQ29udGV4dD4+ID0ge307XHJcblxyXG4gIC8qKiBTdHJlYW0gb2YgYW5pbWF0aW9uIGBkb25lYCBldmVudHMgd2hlbiB0aGUgYm9keSBleHBhbmRzL2NvbGxhcHNlcy4gKi9cclxuICByZWFkb25seSBfYW5pbWF0aW9uRG9uZSA9IG5ldyBTdWJqZWN0PEFuaW1hdGlvbkV2ZW50PigpO1xyXG5cclxuICAvKiogRHVyYXRpb24gZm9yIHRoZSBhbmltYXRpb24uIFdpbGwgYmUgbm9ybWFsaXplZCB0byBtaWxsaXNlY29uZHMgaWYgbm8gdW5pdHMgYXJlIHNldC4gKi9cclxuICBASW5wdXQoKVxyXG4gIGdldCBhbmltYXRpb25EdXJhdGlvbigpOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuIHRoaXMuX2FuaW1hdGlvbkR1cmF0aW9uO1xyXG4gIH1cclxuICBzZXQgYW5pbWF0aW9uRHVyYXRpb24odmFsdWU6IHN0cmluZykge1xyXG4gICAgdGhpcy5fYW5pbWF0aW9uRHVyYXRpb24gPSAvXlxcZCskLy50ZXN0KHZhbHVlKSA/IHZhbHVlICsgJ21zJyA6IHZhbHVlO1xyXG4gIH1cclxuICBwcml2YXRlIF9hbmltYXRpb25EdXJhdGlvbiA9ICcnO1xyXG4gIHByaXZhdGUgb25DaGFuZ2VTdWI6IFN1YnNjcmlwdGlvbiA9IG5ldyBTdWJzY3JpcHRpb24oKTtcclxuICBpc01vYmlsZSA9IGZhbHNlO1xyXG5cclxuICBjb25zdHJ1Y3RvcihcclxuICAgIEBPcHRpb25hbCgpIGRpcjogRGlyZWN0aW9uYWxpdHksXHJcbiAgICBjaGFuZ2VEZXRlY3RvclJlZjogQ2hhbmdlRGV0ZWN0b3JSZWYsXHJcbiAgICBlbGVtZW50UmVmOiBFbGVtZW50UmVmPEhUTUxFbGVtZW50PixcclxuICAgIHByaXZhdGUgYnJlYWtwb2ludE9ic2VydmVyOiBCcmVha3BvaW50T2JzZXJ2ZXIsXHJcbiAgICBwcml2YXRlIGNkcjogQ2hhbmdlRGV0ZWN0b3JSZWYpIHtcclxuICAgIHN1cGVyKGRpciwgY2hhbmdlRGV0ZWN0b3JSZWYsIGVsZW1lbnRSZWYpO1xyXG4gICAgY29uc3Qgbm9kZU5hbWUgPSBlbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtcclxuICAgIHRoaXMub3JpZW50YXRpb24gPSBub2RlTmFtZSA9PT0gJ2Vzbi12ZXJ0aWNhbC1zdGVwcGVyJyA/ICd2ZXJ0aWNhbCcgOiAnaG9yaXpvbnRhbCc7XHJcbiAgfVxyXG5cclxuICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgIC8vIGRldGVjdCBzY3JlZW4gc2l6ZSBjaGFuZ2VzXHJcbiAgICB0aGlzLm9uQ2hhbmdlU3ViLmFkZCh0aGlzLmJyZWFrcG9pbnRPYnNlcnZlci5vYnNlcnZlKFtcclxuICAgICAgYChtYXgtd2lkdGg6ICR7RXNuVXRpbHMuQlJFQUtQT0lOVFMubW9iaWxlfSlgXHJcbiAgICBdKS5zdWJzY3JpYmUoKHJlc3VsdDogQnJlYWtwb2ludFN0YXRlKSA9PiB7XHJcbiAgICAgIHRoaXMuaXNNb2JpbGUgPSByZXN1bHQubWF0Y2hlcztcclxuICAgICAgdGhpcy5jZHIuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgfSkpO1xyXG4gIH1cclxuXHJcbiAgb3ZlcnJpZGUgbmdPbkRlc3Ryb3koKSB7XHJcbiAgICB0aGlzLm9uQ2hhbmdlU3ViLnVuc3Vic2NyaWJlKCk7XHJcbiAgfVxyXG5cclxuICBvdmVycmlkZSBuZ0FmdGVyQ29udGVudEluaXQoKSB7XHJcbiAgICBzdXBlci5uZ0FmdGVyQ29udGVudEluaXQoKTtcclxuICAgIHRoaXMuX2ljb25zLmZvckVhY2goKHtuYW1lLCB0ZW1wbGF0ZVJlZn0pID0+ICh0aGlzLl9pY29uT3ZlcnJpZGVzW25hbWVdID0gdGVtcGxhdGVSZWYpKTtcclxuXHJcbiAgICAvLyBNYXJrIHRoZSBjb21wb25lbnQgZm9yIGNoYW5nZSBkZXRlY3Rpb24gd2hlbmV2ZXIgdGhlIGNvbnRlbnQgY2hpbGRyZW4gcXVlcnkgY2hhbmdlc1xyXG4gICAgdGhpcy5zdGVwcy5jaGFuZ2VzLnBpcGUodGFrZVVudGlsKHRoaXMuX2Rlc3Ryb3llZCkpLnN1YnNjcmliZSgoKSA9PiB7XHJcbiAgICAgIHRoaXMuX3N0YXRlQ2hhbmdlZCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fYW5pbWF0aW9uRG9uZVxyXG4gICAgICAucGlwZShcclxuICAgICAgICAvLyBUaGlzIG5lZWRzIGEgYGRpc3RpbmN0VW50aWxDaGFuZ2VkYCBpbiBvcmRlciB0byBhdm9pZCBlbWl0dGluZyB0aGUgc2FtZSBldmVudCB0d2ljZSBkdWVcclxuICAgICAgICAvLyB0byBhIGJ1ZyBpbiBhbmltYXRpb25zIHdoZXJlIHRoZSBgLmRvbmVgIGNhbGxiYWNrIGdldHMgaW52b2tlZCB0d2ljZSBvbiBzb21lIGJyb3dzZXJzLlxyXG4gICAgICAgIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vYW5ndWxhci9hbmd1bGFyL2lzc3Vlcy8yNDA4NFxyXG4gICAgICAgIGRpc3RpbmN0VW50aWxDaGFuZ2VkKCh4LCB5KSA9PiB4LmZyb21TdGF0ZSA9PT0geS5mcm9tU3RhdGUgJiYgeC50b1N0YXRlID09PSB5LnRvU3RhdGUpLFxyXG4gICAgICAgIHRha2VVbnRpbCh0aGlzLl9kZXN0cm95ZWQpLFxyXG4gICAgICApXHJcbiAgICAgIC5zdWJzY3JpYmUoZXZlbnQgPT4ge1xyXG4gICAgICAgIGlmICgoZXZlbnQudG9TdGF0ZSBhcyBTdGVwQ29udGVudFBvc2l0aW9uU3RhdGUpID09PSAnY3VycmVudCcpIHtcclxuICAgICAgICAgIHRoaXMuYW5pbWF0aW9uRG9uZS5lbWl0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIF9zdGVwSXNOYXZpZ2FibGUoaW5kZXg6IG51bWJlciwgc3RlcDogRXNuU3RlcCk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHN0ZXAuY29tcGxldGVkIHx8IHRoaXMuc2VsZWN0ZWRJbmRleCA9PT0gaW5kZXggfHwgIXRoaXMubGluZWFyO1xyXG4gIH1cclxuXHJcbiAgX2dldEFuaW1hdGlvbkR1cmF0aW9uKCkge1xyXG4gICAgaWYgKHRoaXMuYW5pbWF0aW9uRHVyYXRpb24pIHtcclxuICAgICAgcmV0dXJuIHRoaXMuYW5pbWF0aW9uRHVyYXRpb247XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHRoaXMub3JpZW50YXRpb24gPT09ICdob3Jpem9udGFsJ1xyXG4gICAgICA/IERFRkFVTFRfSE9SSVpPTlRBTF9BTklNQVRJT05fRFVSQVRJT05cclxuICAgICAgOiBERUZBVUxUX1ZFUlRJQ0FMX0FOSU1BVElPTl9EVVJBVElPTjtcclxuICB9XHJcbn1cclxuIiwiPG5nLXRlbXBsYXRlPlxyXG4gIDxuZy1jb250ZW50PjwvbmctY29udGVudD5cclxuICA8bmctdGVtcGxhdGUgW2Nka1BvcnRhbE91dGxldF09XCJfcG9ydGFsXCI+PC9uZy10ZW1wbGF0ZT5cclxuPC9uZy10ZW1wbGF0ZT5cclxuIiwiXHJcblxyXG5cclxuICAgIFxyXG4gIDxuZy1jb250YWluZXIgKm5nSWY9XCIhaXNNb2JpbGU7IGVsc2UgbW9iaWxlVmVyc2lvblwiPlxyXG4gICAgPG5nLWNvbnRhaW5lciBbbmdTd2l0Y2hdPVwib3JpZW50YXRpb25cIj5cclxuICAgICAgPCEtLSBIb3Jpem9udGFsIHN0ZXBwZXIgLS0+XHJcbiAgICAgIDxkaXYgY2xhc3M9XCJlc24taG9yaXpvbnRhbC1zdGVwcGVyLXdyYXBwZXJcIiAqbmdTd2l0Y2hDYXNlPVwiJ2hvcml6b250YWwnXCI+XHJcbiAgICAgICAgPGRpdiBjbGFzcz1cImVzbi1ob3Jpem9udGFsLXN0ZXBwZXItaGVhZGVyLWNvbnRhaW5lclwiPlxyXG4gICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdGb3I9XCJsZXQgc3RlcCBvZiBzdGVwczsgbGV0IGkgPSBpbmRleDsgbGV0IGlzTGFzdCA9IGxhc3RcIj5cclxuICAgICAgICAgICAgPG5nLWNvbnRhaW5lclxyXG4gICAgICAgICAgICAgIFtuZ1RlbXBsYXRlT3V0bGV0XT1cInN0ZXBUZW1wbGF0ZVwiXHJcbiAgICAgICAgICAgICAgW25nVGVtcGxhdGVPdXRsZXRDb250ZXh0XT1cIntzdGVwOiBzdGVwLCBpOiBpfVwiPjwvbmctY29udGFpbmVyPlxyXG4gICAgICAgICAgICA8ZGl2ICpuZ0lmPVwiIWlzTGFzdFwiIGNsYXNzPVwiZXNuLXN0ZXBwZXItaG9yaXpvbnRhbC1saW5lXCI+PC9kaXY+XHJcbiAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cclxuICAgICAgICA8L2Rpdj5cclxuICBcclxuICAgICAgICA8ZGl2IGNsYXNzPVwiZXNuLWhvcml6b250YWwtY29udGVudC1jb250YWluZXJcIj5cclxuICAgICAgICAgIDxkaXYgKm5nRm9yPVwibGV0IHN0ZXAgb2Ygc3RlcHM7IGxldCBpID0gaW5kZXhcIlxyXG4gICAgICAgICAgICAgICBjbGFzcz1cImVzbi1ob3Jpem9udGFsLXN0ZXBwZXItY29udGVudFwiIHJvbGU9XCJ0YWJwYW5lbFwiXHJcbiAgICAgICAgICAgICAgIFtAaG9yaXpvbnRhbFN0ZXBUcmFuc2l0aW9uXT1cIntcclxuICAgICAgICAgICAgICAgICd2YWx1ZSc6IF9nZXRBbmltYXRpb25EaXJlY3Rpb24oaSksXHJcbiAgICAgICAgICAgICAgICAncGFyYW1zJzogeydhbmltYXRpb25EdXJhdGlvbic6IF9nZXRBbmltYXRpb25EdXJhdGlvbigpfVxyXG4gICAgICAgICAgICAgIH1cIlxyXG4gICAgICAgICAgICAgICAoQGhvcml6b250YWxTdGVwVHJhbnNpdGlvbi5kb25lKT1cIl9hbmltYXRpb25Eb25lLm5leHQoJGV2ZW50KVwiXHJcbiAgICAgICAgICAgICAgIFtpZF09XCJfZ2V0U3RlcENvbnRlbnRJZChpKVwiXHJcbiAgICAgICAgICAgICAgIFthdHRyLmFyaWEtbGFiZWxsZWRieV09XCJfZ2V0U3RlcExhYmVsSWQoaSlcIlxyXG4gICAgICAgICAgICAgICBbY2xhc3MuZXNuLWhvcml6b250YWwtc3RlcHBlci1jb250ZW50LWluYWN0aXZlXT1cInNlbGVjdGVkSW5kZXggIT09IGlcIj5cclxuICAgICAgICAgICAgPG5nLWNvbnRhaW5lciBbbmdUZW1wbGF0ZU91dGxldF09XCJzdGVwLmNvbnRlbnRcIj48L25nLWNvbnRhaW5lcj5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICA8L2Rpdj5cclxuICAgICAgPCEtLSBWZXJ0aWNhbCBzdGVwcGVyIC0tPlxyXG4gICAgICA8bmctY29udGFpbmVyICpuZ1N3aXRjaENhc2U9XCIndmVydGljYWwnXCI+XHJcbiAgICA8IS0tIERldGFjaGVkIGNvbnRlbnQgLS0+XHJcbiAgICAgICAgPGRpdiBjbGFzcz1cImRldGFjaGVkX19jb250YWluZXJcIiAqbmdJZj1cImRldGFjaENvbnRlbnQ7IGVsc2UgdmVydGljYWxcIj5cclxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJkZXRhY2hlZF9fc3RlcHNcIj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImVzbi1zdGVwXCIgKm5nRm9yPVwibGV0IHN0ZXAgb2Ygc3RlcHM7IGxldCBpID0gaW5kZXg7IGxldCBpc0xhc3QgPSBsYXN0XCI+XHJcbiAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lclxyXG4gICAgICAgICAgICAgICAgW25nVGVtcGxhdGVPdXRsZXRdPVwic3RlcFRlbXBsYXRlXCJcclxuICAgICAgICAgICAgICAgIFtuZ1RlbXBsYXRlT3V0bGV0Q29udGV4dF09XCJ7c3RlcDogc3RlcCwgaTogaX1cIj48L25nLWNvbnRhaW5lcj5cclxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZXNuLXZlcnRpY2FsLWNvbnRlbnQtY29udGFpbmVyXCIgW2NsYXNzLmVzbi1zdGVwcGVyLXZlcnRpY2FsLWxpbmVdPVwiIWlzTGFzdFwiPlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImVzbi12ZXJ0aWNhbC1zdGVwcGVyLWNvbnRlbnRcIiByb2xlPVwidGFicGFuZWxcIlxyXG4gICAgICAgICAgICAgICAgICAgIFtAdmVydGljYWxTdGVwVHJhbnNpdGlvbl09XCJ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAndmFsdWUnOiBfZ2V0QW5pbWF0aW9uRGlyZWN0aW9uKGkpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgJ3BhcmFtcyc6IHsnYW5pbWF0aW9uRHVyYXRpb24nOiBfZ2V0QW5pbWF0aW9uRHVyYXRpb24oKX1cclxuICAgICAgICAgICAgICAgICAgICB9XCJcclxuICAgICAgICAgICAgICAgICAgICAoQHZlcnRpY2FsU3RlcFRyYW5zaXRpb24uZG9uZSk9XCJfYW5pbWF0aW9uRG9uZS5uZXh0KCRldmVudClcIlxyXG4gICAgICAgICAgICAgICAgICAgIFtpZF09XCJfZ2V0U3RlcENvbnRlbnRJZChpKVwiXHJcbiAgICAgICAgICAgICAgICAgICAgW2F0dHIuYXJpYS1sYWJlbGxlZGJ5XT1cIl9nZXRTdGVwTGFiZWxJZChpKVwiXHJcbiAgICAgICAgICAgICAgICAgICAgW2NsYXNzLmVzbi12ZXJ0aWNhbC1zdGVwcGVyLWNvbnRlbnQtaW5hY3RpdmVdPVwic2VsZWN0ZWRJbmRleCAhPT0gaVwiPlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiZGV0YWNoZWRfX2NvbnRlbnRcIj5cclxuICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cInNlbGVjdGVkXCIgW25nVGVtcGxhdGVPdXRsZXRdPVwic2VsZWN0ZWQuY29udGVudFwiPjwvbmctY29udGFpbmVyPlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPG5nLXRlbXBsYXRlICAjdmVydGljYWw+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiZXNuLXN0ZXBcIiAqbmdGb3I9XCJsZXQgc3RlcCBvZiBzdGVwczsgbGV0IGkgPSBpbmRleDsgbGV0IGlzTGFzdCA9IGxhc3RcIj5cclxuICAgICAgICAgICAgPG5nLWNvbnRhaW5lclxyXG4gICAgICAgICAgICAgIFtuZ1RlbXBsYXRlT3V0bGV0XT1cInN0ZXBUZW1wbGF0ZVwiXHJcbiAgICAgICAgICAgICAgW25nVGVtcGxhdGVPdXRsZXRDb250ZXh0XT1cIntzdGVwOiBzdGVwLCBpOiBpfVwiPjwvbmctY29udGFpbmVyPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZXNuLXZlcnRpY2FsLWNvbnRlbnQtY29udGFpbmVyXCIgW2NsYXNzLmVzbi1zdGVwcGVyLXZlcnRpY2FsLWxpbmVdPVwiIWlzTGFzdFwiPlxyXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJlc24tdmVydGljYWwtc3RlcHBlci1jb250ZW50XCIgcm9sZT1cInRhYnBhbmVsXCJcclxuICAgICAgICAgICAgICAgICAgIFtAdmVydGljYWxTdGVwVHJhbnNpdGlvbl09XCJ7XHJcbiAgICAgICAgICAgICAgICAgICAgJ3ZhbHVlJzogX2dldEFuaW1hdGlvbkRpcmVjdGlvbihpKSxcclxuICAgICAgICAgICAgICAgICAgICAncGFyYW1zJzogeydhbmltYXRpb25EdXJhdGlvbic6IF9nZXRBbmltYXRpb25EdXJhdGlvbigpfVxyXG4gICAgICAgICAgICAgICAgICB9XCJcclxuICAgICAgICAgICAgICAgICAgIChAdmVydGljYWxTdGVwVHJhbnNpdGlvbi5kb25lKT1cIl9hbmltYXRpb25Eb25lLm5leHQoJGV2ZW50KVwiXHJcbiAgICAgICAgICAgICAgICAgICBbaWRdPVwiX2dldFN0ZXBDb250ZW50SWQoaSlcIlxyXG4gICAgICAgICAgICAgICAgICAgW2F0dHIuYXJpYS1sYWJlbGxlZGJ5XT1cIl9nZXRTdGVwTGFiZWxJZChpKVwiXHJcbiAgICAgICAgICAgICAgICAgICBbY2xhc3MuZXNuLXZlcnRpY2FsLXN0ZXBwZXItY29udGVudC1pbmFjdGl2ZV09XCJzZWxlY3RlZEluZGV4ICE9PSBpXCI+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZXNuLXZlcnRpY2FsLWNvbnRlbnRcIj5cclxuICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciBbbmdUZW1wbGF0ZU91dGxldF09XCJzdGVwLmNvbnRlbnRcIj48L25nLWNvbnRhaW5lcj5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvbmctdGVtcGxhdGU+XHJcbiAgICAgIDwvbmctY29udGFpbmVyPlxyXG4gIDwvbmctY29udGFpbmVyPlxyXG4gICAgPC9uZy1jb250YWluZXI+XHJcbiAgXHJcbiAgPCEtLSBNb2JpbGUgdmVyc2lvbiAtLT5cclxuICA8bmctdGVtcGxhdGUgI21vYmlsZVZlcnNpb24+XHJcbiAgICA8ZGl2IGNsYXNzPVwiZXNuLXN0ZXAgbW9iaWxlX3N0ZXBzX2NvbnRhaW5lclwiICpuZ0Zvcj1cImxldCBzdGVwIG9mIHN0ZXBzOyBsZXQgaSA9IGluZGV4OyBsZXQgaXNMYXN0ID0gbGFzdFwiPlxyXG4gICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwic2VsZWN0ZWRJbmRleCA9PT0gaVwiXHJcbiAgICAgICAgW25nVGVtcGxhdGVPdXRsZXRdPVwic3RlcFRlbXBsYXRlXCJcclxuICAgICAgICBbbmdUZW1wbGF0ZU91dGxldENvbnRleHRdPVwie3N0ZXA6IHN0ZXAsIGk6IGl9XCI+PC9uZy1jb250YWluZXI+XHJcbiAgICA8L2Rpdj5cclxuICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJzZWxlY3RlZFwiIFtuZ1RlbXBsYXRlT3V0bGV0XT1cInNlbGVjdGVkLmNvbnRlbnRcIj48L25nLWNvbnRhaW5lcj5cclxuICA8L25nLXRlbXBsYXRlPlxyXG5cclxuICA8IS0tIENvbW1vbiBzdGVwIHRlbXBsYXRpbmcgLS0+XHJcbiAgPG5nLXRlbXBsYXRlIGxldC1zdGVwPVwic3RlcFwiIGxldC1pPVwiaVwiICNzdGVwVGVtcGxhdGU+XHJcbiAgICA8ZXNuLXN0ZXAtaGVhZGVyXHJcbiAgICAgIFtjbGFzcy5lc24taG9yaXpvbnRhbC1zdGVwcGVyLWhlYWRlcl09XCJvcmllbnRhdGlvbiA9PT0gJ2hvcml6b250YWwnXCJcclxuICAgICAgW2NsYXNzLmVzbi12ZXJ0aWNhbC1zdGVwcGVyLWhlYWRlcl09XCJvcmllbnRhdGlvbiA9PT0gJ3ZlcnRpY2FsJ1wiXHJcbiAgICAgIChjbGljayk9XCJzdGVwLnNlbGVjdCgpXCJcclxuICAgICAgKGtleWRvd24pPVwiX29uS2V5ZG93bigkZXZlbnQpXCJcclxuICAgICAgW3RhYkluZGV4XT1cIl9nZXRGb2N1c0luZGV4KCkgPT09IGkgPyAwIDogLTFcIlxyXG4gICAgICBbaWRdPVwiX2dldFN0ZXBMYWJlbElkKGkpXCJcclxuICAgICAgW2F0dHIuYXJpYS1wb3NpbnNldF09XCJpICsgMVwiXHJcbiAgICAgIFthdHRyLmFyaWEtc2V0c2l6ZV09XCJzdGVwcy5sZW5ndGhcIlxyXG4gICAgICBbYXR0ci5hcmlhLWNvbnRyb2xzXT1cIl9nZXRTdGVwQ29udGVudElkKGkpXCJcclxuICAgICAgW2F0dHIuYXJpYS1zZWxlY3RlZF09XCJzZWxlY3RlZEluZGV4ID09IGlcIlxyXG4gICAgICBbYXR0ci5hcmlhLWxhYmVsXT1cInN0ZXAuYXJpYUxhYmVsIHx8IG51bGxcIlxyXG4gICAgICBbYXR0ci5hcmlhLWxhYmVsbGVkYnldPVwiKCFzdGVwLmFyaWFMYWJlbCAmJiBzdGVwLmFyaWFMYWJlbGxlZGJ5KSA/IHN0ZXAuYXJpYUxhYmVsbGVkYnkgOiBudWxsXCJcclxuICAgICAgW2F0dHIuYXJpYS1kaXNhYmxlZF09XCJfc3RlcElzTmF2aWdhYmxlKGksIHN0ZXApID8gbnVsbCA6IHRydWVcIlxyXG4gICAgICBbaW5kZXhdPVwiaVwiXHJcbiAgICAgIFtzdGF0ZV09XCJfZ2V0SW5kaWNhdG9yVHlwZShpLCBzdGVwLnN0YXRlKVwiXHJcbiAgICAgIFtsYWJlbF09XCJzdGVwLnN0ZXBMYWJlbCB8fCBzdGVwLmxhYmVsXCJcclxuICAgICAgW3NlbGVjdGVkXT1cInNlbGVjdGVkSW5kZXggPT09IGlcIlxyXG4gICAgICBbYWN0aXZlXT1cIl9zdGVwSXNOYXZpZ2FibGUoaSwgc3RlcClcIlxyXG4gICAgICBbb3B0aW9uYWxdPVwic3RlcC5vcHRpb25hbFwiXHJcbiAgICAgIFtlcnJvck1lc3NhZ2VdPVwic3RlcC5lcnJvck1lc3NhZ2VcIlxyXG4gICAgICBbaWNvbk92ZXJyaWRlc109XCJfaWNvbk92ZXJyaWRlc1wiXHJcbiAgICAgIFtkaXNhYmxlUmlwcGxlXT1cImRpc2FibGVSaXBwbGUgfHwgIV9zdGVwSXNOYXZpZ2FibGUoaSwgc3RlcClcIlxyXG4gICAgICBbZXNuSWNvbl09XCJzdGVwLmVzbkljb25cIlxyXG4gICAgICBbaXNNb2JpbGVdPVwiaXNNb2JpbGVcIlxyXG4gICAgICBbc3RlcHNOdW1iZXJdPVwic3RlcHM/Lmxlbmd0aFwiXHJcbiAgICA+PC9lc24tc3RlcC1oZWFkZXI+XHJcbiAgPC9uZy10ZW1wbGF0ZT4iXX0=